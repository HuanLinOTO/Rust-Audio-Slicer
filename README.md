# ğŸµ Audio Slicer - é«˜æ€§èƒ½éŸ³é¢‘åˆ‡ç‰‡å·¥å…·

ä¸€ä¸ªåŸºäº Rust å¼€å‘çš„é«˜æ€§èƒ½éŸ³é¢‘åˆ‡ç‰‡å·¥å…·ï¼Œæ”¯æŒå¤šçº¿ç¨‹å¹¶è¡Œå¤„ç†ã€æ™ºèƒ½é™éŸ³æ£€æµ‹å’Œæ‰¹é‡æ–‡ä»¶å¤„ç†ã€‚

> [!WARNING]  
> è¯¥é¡¹ç›®ç”± MetaSo + Claude Sonnet 4 ç”Ÿæˆï¼Œä¸ä¿è¯å¯é æ€§

## âœ¨ ç‰¹æ€§

- ğŸš€ **é«˜æ€§èƒ½å¤„ç†**: RTF < 0.01ï¼Œå¤„ç†é€Ÿåº¦æ¯”å®æ—¶æ’­æ”¾å¿« 130+å€
- ğŸ§µ **å¤šçº¿ç¨‹å¹¶è¡Œ**: æ”¯æŒå¤šçº¿ç¨‹å¹¶è¡Œå¤„ç†ï¼Œå¯é…ç½®çº¿ç¨‹æ•°
- ğŸ“Š **å®æ—¶è¿›åº¦æ¡**: ç¾è§‚çš„è¿›åº¦æ¡æ˜¾ç¤ºå¤„ç†çŠ¶æ€
- ğŸ” **é€’å½’æœç´¢**: è‡ªåŠ¨é€’å½’æœç´¢ç›®å½•ä¸­çš„æ‰€æœ‰éŸ³é¢‘æ–‡ä»¶
- ğŸ“ **ç›®å½•ç»“æ„ä¿ç•™**: å®Œæ•´ä¿ç•™åŸå§‹ç›®å½•å±‚æ¬¡ç»“æ„
- ğŸ¯ **æ™ºèƒ½é™éŸ³æ£€æµ‹**: è‡ªåŠ¨è¿‡æ»¤é™éŸ³ç‰‡æ®µï¼Œåªä¿ç•™æœ‰æ•ˆéŸ³é¢‘
- ğŸ›ï¸ **å‚æ•°å¯é…ç½®**: æ‰€æœ‰åˆ‡ç‰‡å‚æ•°éƒ½å¯é€šè¿‡å‘½ä»¤è¡Œè°ƒæ•´
- ğŸ“ˆ **è¯¦ç»†ç»Ÿè®¡**: æä¾› RTFã€å¹¶è¡Œæ•ˆç‡ç­‰è¯¦ç»†æ€§èƒ½æŒ‡æ ‡

## ğŸ¼ æ”¯æŒçš„éŸ³é¢‘æ ¼å¼

- WAV
- MP3
- FLAC
- M4A
- AAC
- OGG

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å®‰è£…ä¾èµ–

ç¡®ä¿å·²å®‰è£… [Rust](https://rustup.rs/)ï¼Œç„¶åï¼š

```bash
git clone <repository-url>
cd audio-learning
cargo build --release
```

### åŸºæœ¬ç”¨æ³•

```bash
# å¤„ç†å•ä¸ªæ–‡ä»¶
cargo run -- slice -i input.wav -o slices

# å¤„ç†æ•´ä¸ªç›®å½•ï¼ˆé€’å½’æœç´¢ï¼‰
cargo run -- slice -i audio_folder -o output_folder

# ä½¿ç”¨4ä¸ªçº¿ç¨‹å¹¶è¡Œå¤„ç†
cargo run -- slice -i audio_folder -o output_folder --threads 4
```

## ğŸ”§ å‘½ä»¤è¡Œå‚æ•°

### å¿…éœ€å‚æ•°

- `-i, --input <PATH>`: è¾“å…¥éŸ³é¢‘æ–‡ä»¶æˆ–ç›®å½•è·¯å¾„
- `-o, --output <PATH>`: è¾“å‡ºç›®å½•è·¯å¾„

### å¯é€‰å‚æ•°

- `-t, --threads <NUM>`: å¹¶è¡Œå¤„ç†çº¿ç¨‹æ•°ï¼ˆé»˜è®¤ä¸º CPU æ ¸å¿ƒæ•°ï¼‰
- `--threshold-db <DB>`: é™éŸ³é˜ˆå€¼ï¼Œå•ä½ dBï¼ˆé»˜è®¤: -55.0ï¼‰
- `--min-length-ms <MS>`: æœ€å°ç‰‡æ®µé•¿åº¦ï¼Œå•ä½æ¯«ç§’ï¼ˆé»˜è®¤: 1000ï¼‰
- `--min-interval-ms <MS>`: æœ€å°é—´éš”ï¼Œå•ä½æ¯«ç§’ï¼ˆé»˜è®¤: 100ï¼‰
- `--hop-size-ms <MS>`: è·³è·ƒå¤§å°ï¼Œå•ä½æ¯«ç§’ï¼ˆé»˜è®¤: 5ï¼‰
- `--max-silence-ms <MS>`: æœ€å¤§é™éŸ³é•¿åº¦ï¼Œå•ä½æ¯«ç§’ï¼ˆé»˜è®¤: 800ï¼‰
- `--max-merge-duration-ms <MS>`: æœ€å¤§åˆå¹¶æ—¶é•¿ï¼Œå•ä½æ¯«ç§’ï¼ˆé»˜è®¤: 8000ï¼‰
- `--silence-threshold <FLOAT>`: é™éŸ³æ£€æµ‹é˜ˆå€¼ï¼ˆé»˜è®¤: 0.001ï¼‰
- `--min-audio-ratio <FLOAT>`: æœ€å°æœ‰æ•ˆéŸ³é¢‘å æ¯”ï¼ˆé»˜è®¤: 0.1ï¼‰

### æŸ¥çœ‹å¸®åŠ©

```bash
cargo run -- slice --help
```

## ğŸ“‹ ä½¿ç”¨ç¤ºä¾‹

### 1. åŸºæœ¬åˆ‡ç‰‡å¤„ç†

```bash
# ä½¿ç”¨é»˜è®¤å‚æ•°å¤„ç†å•ä¸ªæ–‡ä»¶
cargo run -- slice -i my_audio.wav -o output

# å¤„ç†ç›®å½•å¹¶ä¿ç•™ç»“æ„
cargo run -- slice -i audio_dataset -o processed_audio
```

### 2. è‡ªå®šä¹‰åˆ‡ç‰‡å‚æ•°

```bash
# æ›´æ¿€è¿›çš„åˆ‡ç‰‡ï¼ˆæ›´å¤šçŸ­ç‰‡æ®µï¼‰
cargo run -- slice -i input.wav -o output \
  --threshold-db -60 \
  --min-length-ms 500 \
  --max-silence-ms 300

# æ›´ä¿å®ˆçš„åˆ‡ç‰‡ï¼ˆæ›´å°‘é•¿ç‰‡æ®µï¼‰
cargo run -- slice -i input.wav -o output \
  --threshold-db -45 \
  --min-length-ms 3000 \
  --max-silence-ms 2000
```

### 3. æ€§èƒ½ä¼˜åŒ–

```bash
# å°æ‰¹é‡æ–‡ä»¶ä½¿ç”¨4çº¿ç¨‹
cargo run -- slice -i small_dataset -o output --threads 4

# å¤§æ‰¹é‡æ–‡ä»¶ä½¿ç”¨æ›´å¤šçº¿ç¨‹
cargo run -- slice -i large_dataset -o output --threads 16
```

## ğŸ“ è¾“å‡ºç»“æ„

å·¥å…·ä¼šå®Œæ•´ä¿ç•™åŸå§‹ç›®å½•ç»“æ„ï¼Œæ¯ä¸ªéŸ³é¢‘æ–‡ä»¶ä¼šç”Ÿæˆä¸€ä¸ªå¯¹åº”çš„æ–‡ä»¶å¤¹ï¼š

```
è¾“å…¥ç›®å½•:
audio_dataset/
â”œâ”€â”€ speaker1/
â”‚   â”œâ”€â”€ recording1.wav
â”‚   â””â”€â”€ recording2.wav
â””â”€â”€ speaker2/
    â””â”€â”€ recording3.wav

è¾“å‡ºç›®å½•:
processed_audio/
â”œâ”€â”€ speaker1/
â”‚   â”œâ”€â”€ recording1/
â”‚   â”‚   â”œâ”€â”€ slice_000.wav
â”‚   â”‚   â”œâ”€â”€ slice_001.wav
â”‚   â”‚   â””â”€â”€ slice_002.wav
â”‚   â””â”€â”€ recording2/
â”‚       â”œâ”€â”€ slice_000.wav
â”‚       â””â”€â”€ slice_001.wav
â””â”€â”€ speaker2/
    â””â”€â”€ recording3/
        â”œâ”€â”€ slice_000.wav
        â”œâ”€â”€ slice_001.wav
        â””â”€â”€ slice_002.wav
```

## ğŸ“Š æ€§èƒ½æŒ‡æ ‡

### RTF (Real Time Factor)

- RTF < 0.01 è¡¨ç¤ºå¤„ç†é€Ÿåº¦æ¯”å®æ—¶æ’­æ”¾å¿« 100 å€ä»¥ä¸Š
- å…¸å‹æ€§èƒ½ï¼šå¤„ç† 3 åˆ† 48 ç§’éŸ³é¢‘ä»…éœ€ 1.4 ç§’

### å¤šçº¿ç¨‹æ•ˆç‡

- å°æ‰¹é‡æ–‡ä»¶ï¼ˆ3-10 ä¸ªï¼‰ï¼šæ¨èä½¿ç”¨ 4 çº¿ç¨‹ï¼Œå¹¶è¡Œæ•ˆç‡å¯è¾¾ 70%+
- å¤§æ‰¹é‡æ–‡ä»¶ï¼ˆ100+ä¸ªï¼‰ï¼šæ¨èä½¿ç”¨ CPU æ ¸å¿ƒæ•°çš„çº¿ç¨‹
- æœ€å¤§åŠ é€Ÿæ¯”ï¼šçº¦ 3 å€ï¼ˆå–å†³äºæ–‡ä»¶æ•°é‡å’Œç¡¬ä»¶é…ç½®ï¼‰

### ç¤ºä¾‹è¾“å‡º

```
ğŸš€ æ€§èƒ½æŒ‡æ ‡:
   - æ•´ä½“RTF: 0.008x
   - å¤„ç†é€Ÿåº¦æ¯”å®æ—¶æ’­æ”¾å¿« 132.5å€
   - å¹³å‡æ¯ä¸ªæ–‡ä»¶å¤„ç†æ—¶é—´: 1.73s
   - å¹¶è¡ŒåŠ é€Ÿæ¯”: 2.94x (ä½¿ç”¨4çº¿ç¨‹)
   - å¹¶è¡Œæ•ˆç‡: 73.6%
```

## ğŸ”§ é«˜çº§é…ç½®

### é™éŸ³æ£€æµ‹è°ƒä¼˜

- **threshold-db**: è¶Šä½è¶Šæ•æ„Ÿï¼Œ-60dB ä¼šæ£€æµ‹åˆ°éå¸¸å¾®å¼±çš„é™éŸ³
- **silence-threshold**: çº¿æ€§é˜ˆå€¼ï¼Œ0.001 çº¦ç­‰äº-60dB
- **min-audio-ratio**: æœ‰æ•ˆéŸ³é¢‘å æ¯”ï¼Œ0.1 è¡¨ç¤ºè‡³å°‘ 10%ä¸ºæœ‰æ•ˆéŸ³é¢‘

### åˆ‡ç‰‡é•¿åº¦æ§åˆ¶

- **min-length-ms**: æ§åˆ¶æœ€çŸ­ç‰‡æ®µé•¿åº¦ï¼Œé¿å…è¿‡çŸ­çš„åˆ‡ç‰‡
- **max-merge-duration-ms**: æ§åˆ¶åˆå¹¶åçš„æœ€å¤§é•¿åº¦
- **hop-size-ms**: åˆ†æç²¾åº¦ï¼Œè¶Šå°è¶Šç²¾ç¡®ä½†å¤„ç†æ—¶é—´æ›´é•¿

## ğŸ› ï¸ å¼€å‘è¯´æ˜

### é¡¹ç›®ç»“æ„

```
src/
â”œâ”€â”€ main.rs     # CLIç•Œé¢å’Œä¸»ç¨‹åºé€»è¾‘
â”œâ”€â”€ audio.rs    # éŸ³é¢‘æ–‡ä»¶åŠ è½½å’Œæ ¼å¼è½¬æ¢
â””â”€â”€ slicer.rs   # åˆ‡ç‰‡ç®—æ³•å’Œé™éŸ³æ£€æµ‹
```

### æ ¸å¿ƒæŠ€æœ¯

- **éŸ³é¢‘å¤„ç†**: Symphonia åº“ï¼Œæ”¯æŒå¤šç§éŸ³é¢‘æ ¼å¼
- **å¹¶è¡Œå¤„ç†**: Rayon æ•°æ®å¹¶è¡Œæ¡†æ¶
- **è¿›åº¦æ˜¾ç¤º**: Indicatif è¿›åº¦æ¡åº“
- **CLI**: Clap å‘½ä»¤è¡Œè§£æåº“

### ç¼–è¯‘é€‰é¡¹

```bash
# å¼€å‘æ¨¡å¼ï¼ˆåŒ…å«è°ƒè¯•ä¿¡æ¯ï¼‰
cargo build

# å‘å¸ƒæ¨¡å¼ï¼ˆæ€§èƒ½ä¼˜åŒ–ï¼‰
cargo build --release

# è¿è¡Œæµ‹è¯•
cargo test
```

## ğŸ“ˆ ä½¿ç”¨å»ºè®®

### å‚æ•°è°ƒä¼˜æŒ‡å—

1. **è¯­éŸ³æ•°æ®å¤„ç†**:

   ```bash
   --threshold-db -50 --min-length-ms 1000 --max-silence-ms 500
   ```

2. **éŸ³ä¹åˆ‡ç‰‡**:

   ```bash
   --threshold-db -60 --min-length-ms 2000 --max-silence-ms 1000
   ```

3. **æ’­å®¢/è®²åº§**:
   ```bash
   --threshold-db -45 --min-length-ms 5000 --max-silence-ms 2000
   ```

### æ€§èƒ½ä¼˜åŒ–å»ºè®®

- å¯¹äº SSD å­˜å‚¨ï¼Œå¯ä»¥ä½¿ç”¨æ›´å¤šçº¿ç¨‹
- å¯¹äºæœºæ¢°ç¡¬ç›˜ï¼Œå»ºè®®é™åˆ¶çº¿ç¨‹æ•°ä¸º 4-8
- å†…å­˜ä¸è¶³æ—¶ï¼Œå‡å°‘å¹¶è¡Œçº¿ç¨‹æ•°
- å¤„ç†å¤§æ–‡ä»¶æ—¶ï¼Œè€ƒè™‘å¢åŠ  `hop-size-ms`

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

## ğŸ™ è‡´è°¢

- [Symphonia](https://github.com/pdeljanov/Symphonia) - éŸ³é¢‘è§£ç åº“
- [Rayon](https://github.com/rayon-rs/rayon) - æ•°æ®å¹¶è¡Œåº“
- [Indicatif](https://github.com/console-rs/indicatif) - è¿›åº¦æ¡åº“
- [Clap](https://github.com/clap-rs/clap) - å‘½ä»¤è¡Œè§£æåº“
